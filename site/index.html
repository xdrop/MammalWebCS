<html>
<head>
<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.1.8/semantic.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.1.8/semantic.min.js"></script>
<title>MammalWeb</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
    MammalWeb
</title>
</head>
<body>
<div class="ui top attached menu">
<div class="ui header item">MammalWeb</div>
<div class="ui item">Home</div>
<div class="ui item">Users</div>
<div class="ui item">Scientists</div>
</div>
<!-- Filter for animal species-->
<div class = "ui container segment">
<h2>Animal Species</h2>
<select id ="dropdown" class="ui fluid search dropdown" multiple="">
  <option value="">Animal</option>
  <option value="20">Rabbit</option>
  <option value="22">Deer</option>
  <option value="21">Fox</option>
  <option value="14">Dog</option>
  <option value="12">Cat</option>
</select>
<button id="test" class = "ui primary button">Apply filter</button>
<div id="test_area"></div>
<!--Results of animal filter-->
<div class="ui accordion" id="animalAccordion">
  <div class="title">
    <i class="dropdown icon"></i>
    Toggle filter results
  </div>
  <div class="content">
    <p id="animalResults">No results yet</p>
  </div>
</div>

<script type="text/javascript">
$("#test").click(function(){
	if($("#dropdown").val() != null)
	{
		$.ajax({
			url:"http://localhost/MammalWebCS/PHP/src/classes/Database/Queries/runQuery.php",
			type: "GET",
			data:{"query":$("#dropdown").val()},
			success: function(response) {
				var results = ""
				var parsed = JSON.parse(response)["filterResults"];
				for(var i = 0 ; i < parsed.length ; i++)
				{
					results += "<b>Image " + (i+1) + "</b><br/>"; 
					for(var j in parsed[i])
					{
						results += j.toString() + ": " + parsed[i][j] + "<br/>"; //Write the results
					}
					results += "<br/>";
				}
				if(results != "")
				{
					$("#animalResults").html(results);
				}
				else
				{
					$("#animalResults").html("No results");
				}

			},
			error: function(){
				alert("It does not work...");
			}
			});
	}
	else
	{
		$("#animalResults").html("");
	}
});

    $(document).ready(function(){
        $('.ui.dropdown')
          .dropdown()
        ;
		$('.ui.accordion')
			.accordion()
		;
        $.get("../PHP/src/api/internal/animals.php?action=list", function(data){
			var options = ""
			for(var i in data)
			{
				options += "<option value=" + i + ">" + data[i] + "</option>"; //Make each option in html format
			}
			$("#dropdown").html(options); //Put the options in the dropdown as html 
        });
    });
</script>
</body>
</html>

